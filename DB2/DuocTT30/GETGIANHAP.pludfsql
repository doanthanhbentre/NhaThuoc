CREATE OR REPLACE FUNCTION DUOC.GETGIANHAP 
(
IN MASPSD CHAR(15)
)
RETURNS FLOAT
F1: BEGIN
	DECLARE M_GIANHAP FLOAT;
	SELECT MAX(GIANHAP) INTO M_GIANHAP FROM DUOC.CHITIETNHAP WHERE MASPSD = GETGIANHAP.MASPSD;
	IF (M_GIANHAP IS NULL) THEN
		RETURN 0;
	ELSE
		RETURN M_GIANHAP;
	END IF; 
END F1