CREATE OR REPLACE FUNCTION DUOC.XUATTK 
(
IN NAMTHANG CHAR(6),
IN MAKHO CHAR(2),
IN MASPSD CHAR(15)
) 
RETURNS FLOAT
F1: BEGIN
	DECLARE M_SOLUONG FLOAT;
	SELECT SUM(SOLUONG) INTO M_SOLUONG 
	FROM DUOC.CHITIETXUAT CT JOIN DUOC.PHIEUXUAT PX ON CT.MAPX = PX.MAPX
	WHERE TO_CHAR(NGAY, 'YYYYMM') = XUATTK.NAMTHANG AND MASPSD = XUATTK.MASPSD AND MAKHO = XUATTK.MAKHO;
	IF (M_SOLUONG IS NULL) THEN
		RETURN 0;
	ELSE
		RETURN M_SOLUONG;
	END IF;
END F1