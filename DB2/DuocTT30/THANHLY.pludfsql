CREATE OR REPLACE FUNCTION DUOC.THANHLY 
(
IN NAMTHANG CHAR(6),
IN MAKHO CHAR(2),
IN MASPSD CHAR(15)
) 
RETURNS FLOAT
F1: BEGIN
	DECLARE M_SOLUONG FLOAT;
	SELECT SUM(SOLUONG) INTO M_SOLUONG 
	FROM DUOC.CHITIETTHANHLY CT JOIN DUOC.PHIEUTHANHLY PX ON CT.MATL = PX.MATL
	WHERE TO_CHAR(NGAY, 'YYYYMM') = THANHLY.NAMTHANG AND MASPSD = THANHLY.MASPSD AND MAKHO = THANHLY.MAKHO;
	IF (M_SOLUONG IS NULL) THEN
		RETURN 0;
	ELSE
		RETURN M_SOLUONG;
	END IF;
END F1