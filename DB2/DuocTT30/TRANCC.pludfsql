CREATE OR REPLACE FUNCTION DUOC.TRANCC 
(
IN NAMTHANG CHAR(6),
IN MAKHO CHAR(2),
IN MASPSD CHAR(15)
) 
RETURNS FLOAT
F1: BEGIN
	DECLARE M_SOLUONG FLOAT;
	SELECT SUM(SOLUONG) INTO M_SOLUONG 
	FROM DUOC.CHITIETTRANCC CT JOIN DUOC.PHIEUTRANCC PX ON CT.MAPTNCC = PX.MAPTNCC
	WHERE TO_CHAR(NGAY, 'YYYYMM') = TRANCC.NAMTHANG AND MASPSD = TRANCC.MASPSD AND MAKHO = TRANCC.MAKHO;
	IF (M_SOLUONG IS NULL) THEN
		RETURN 0;
	ELSE
		RETURN M_SOLUONG;
	END IF;
END F1